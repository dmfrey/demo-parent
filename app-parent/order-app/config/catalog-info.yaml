---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: order-app
  description: Order App
  tags:
    - java
    - spring
    - jpa
    - sql
    - tanzu
  annotations:
    'backstage.io/kubernetes-label-selector': 'app.kubernetes.io/part-of=demo-parent'
spec:
  type: service
  providesApis:
    - order-app-api
  lifecycle: experimental
  owner: dfrey

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: orders-app-api
  description: Orders App API
spec:
  type: openapi
  lifecycle: production
  owner: dfrey
  system: demo-parent
  definition: |
    openapi: 3.0.1
    info:
      title: Orders Endpoint
      description: Gets all orders for a customer
    servers:
      - url: http://order-app.dfrey.tap.h2o-2-1249.h2o.vmware.com
        description: Generated server url
    paths:
      /seed:
        post:
          tags:
            - seed-orders-endpoint
          operationId: seed
          responses:
            "202":
              description: Accepted
      /orders/{customerId}:
        get:
          tags:
            - orders-by-customer-id-endpoint
          operationId: ordersByCustomerId
          parameters:
            - name: customerId
              in: path
              required: true
              schema:
                type: string
          responses:
            "200":
              description: OK
              content:
                '*/*':
                  schema:
                    type: array
                    items:
                      $ref: '#/components/schemas/OrderResponse'
    components:
      schemas:
        OrderResponse:
          type: object
          properties:
            orderId:
              type: string
              format: uuid
            customerId:
              type: string
